# Default values for esddns-operator.

## Global settings
global:
  domain: example.com
  recordName: "@"
  recordTTL: 300

## Gandi API credentials
gandi:
  apiKey: ""  # Required: Set via --set gandi.apiKey=<your-key> or values file

## Image configuration
image:
  repository: esddns
  tag: latest
  pullPolicy: Always

## Operator Daemon Configuration
daemon:
  enabled: true
  
  # Number of replicas (DaemonSet runs on all nodes by default)
  replicas: 1
  
  # Resource limits and requests
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  
  # Logging level
  logLevel: INFO
  
  # Update interval in seconds (300 = 5 minutes)
  updateInterval: 300
  
  # Pod security context
  securityContext:
    runAsNonRoot: false
    runAsUser: 0
    allowPrivilegeEscalation: true
    capabilities:
      add:
        - NET_ADMIN

## Service (Flask web endpoint) Configuration
service:
  enabled: true
  type: LoadBalancer
  port: 80
  targetPort: 51339
  annotations: {}
  
  # For internal cluster access only, use ClusterIP
  # For cloud providers, use LoadBalancer
  # For on-prem, use NodePort
  
  # Resource limits and requests
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  
  # Pod security context for web service
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: false
    capabilities:
      drop:
        - ALL

## Namespace configuration
namespace:
  create: true
  name: esddns-system

## RBAC configuration
rbac:
  create: true
  serviceAccountName: esddns-operator

## Monitoring configuration
monitoring:
  enabled: true
  serviceMonitor:
    enabled: true
    interval: 30s
  prometheusRules:
    enabled: true

## Environment-specific settings
environment: production

## Development settings (used when environment=development)
development:
  logLevel: DEBUG
  updateInterval: 600
  resources:
    requests:
      memory: "128Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"
      cpu: "200m"

## Pod disruption budget
podDisruptionBudget:
  enabled: true
  minAvailable: 1

## Affinity rules
affinity:
  nodeAffinity: {}
  podAffinity: {}
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
              - key: app
                operator: In
                values:
                  - esddns-service
          topologyKey: kubernetes.io/hostname

## Tolerations
tolerations:
  - effect: NoSchedule
    operator: Exists
  - effect: NoExecute
    operator: Exists

## Node selector
nodeSelector:
  kubernetes.io/os: linux

## Init container for config setup
initContainers:
  enabled: true
  busyboxImage: busybox:1.36

## Health check configuration
healthCheck:
  livenessProbe:
    enabled: true
    initialDelaySeconds: 30
    periodSeconds: 60
    timeoutSeconds: 5
    failureThreshold: 3
  
  readinessProbe:
    enabled: true
    initialDelaySeconds: 10
    periodSeconds: 30
    timeoutSeconds: 5
    failureThreshold: 2

## Ingress configuration (optional)
ingress:
  enabled: false
  className: "nginx"
  annotations: {}
  hosts:
    - host: esddns.example.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    enabled: false
    secretName: esddns-tls

## Volume configuration
volumes:
  configMap: esddns-config
  secret: esddns-gandi-credentials
